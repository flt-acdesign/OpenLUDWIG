[Init] Module loaded (ROBUST VERSION)
======================================================================
      MULTI-CASE EXECUTION: 1 cases
======================================================================

>>> CASE 1/1: ball1m
[Init] Loading: ball1m
[Init] ═══════════════════════════════════════════════════════
[Init] STABILITY SETTINGS:
[Init]    Background ν_sgs: 0.000500 → τ_eff_min ≈ 0.5015
[Init]    Sponge f-blending: true
[Init]    Temporal interpolation: true
[Init] ═══════════════════════════════════════════════════════

======================================================================
    LBM SOLVER | D3Q27 | WALE LES | SURFACE FORCE METHOD
    Case: ball1m | 2026-02-01T23:05:44.829
======================================================================

[Config] Stability Settings:
          Background ν_sgs: 0.000500 → τ_eff_min ≈ 0.5015
          Sponge f-blending: true
          Temporal interpolation: true
[Memory] VRAM: 8.85 GB free / 10.00 GB total
[Backend] CUDA: NVIDIA GeForce RTX 3080
[00:00:00.90] Building domain...
[Domain] Loading: C:\01_LBM\v90_2026_02_01_LUDWIG_STL_loads_claude_\CASES\ball1m\ball1m.stl
[Geometry] Loading STL from: C:\01_LBM\v90_2026_02_01_LUDWIG_STL_loads_claude_\CASES\ball1m\ball1m.stl
[Geometry] Format: Binary STL
[Geometry] Loaded 20480 triangles.
[Geometry] Bounds: [-0.5, 0.5] x [-0.5, 0.5] x [-0.5, 0.5]

[High-Re] ═══════════════════════════════════════════════════════
[High-Re] Re = 2.67e+05, L = 1.0000 m, N = 25 cells/L, U_lat = 0.030
[High-Re] Computed τ_fine = 0.500008
[High-Re] Effective τ_min (with ν_sgs_bg) = 0.501500
[High-Re] ⚠ τ ≈ 0.5 (stability limit) - background ν_sgs active
[High-Re] ═══════════════════════════════════════════════════════

╔══════════════════════════════════════════════════════════════════╗
║                 LBM DOMAIN CONFIGURATION SUMMARY                 ║
╠══════════════════════════════════════════════════════════════════╣
║  Case: ball1m                                        ║
║  Re = 266667       | 3 levels | Est. 0.05 GB                    ║
╚══════════════════════════════════════════════════════════════════╝

======================================================================
[Setup] Multi-Level Domain Generation
        Strategy: Geometry-First (Direct Mesh Check)
        Boundary: Bouzidi IBM (finest 1 level(s))
        Temporal Interpolation: ENABLED
======================================================================

--- Level 1 ---
  Generating Full Wind Tunnel for Level 1...
  Full domain: 8×7×7 = 392 blocks
[Domain] SAT Surface Marking...
[Domain] Flood Fill...
[Domain] Filled 28 interior voxels.
[Domain] Applying Sponge Layers...
[Domain] Sponge: 34.0% cells affected, max strength = 0.993
[Domain] Computing wall distances...
[Domain] Found 405 near-wall cells
  Total: 392 blocks, 0.20 M voxels
  Boundary: Simple bounce-back

--- Level 2 ---
  Added 988 halo blocks
[Domain] SAT Surface Marking...
[Domain] Flood Fill...
[Domain] Filled 548 interior voxels.
[Domain] Applying Sponge Layers...
[Domain] Sponge: 0.0% cells affected, max strength = 0.000
[Domain] Computing wall distances...
[Domain] Found 1160 near-wall cells
  Total: 1000 blocks, 0.51 M voxels
  Boundary: Simple bounce-back

--- Level 3 ---
  Added 1660 halo blocks
[Domain] SAT Surface Marking...
[Domain] Flood Fill...
[Domain] Filled 6084 interior voxels.
[Domain] Applying Sponge Layers...
[Domain] Sponge: 0.0% cells affected, max strength = 0.000
[Domain] Computing wall distances...
[Domain] Found 3627 near-wall cells
[Bouzidi] Computing Q-map and surface mapping for Level 3...
[Bouzidi] Computing Q-values and surface mapping for 1728 blocks...
[Bouzidi] Found 5824 boundary cells (0.66%)
[Bouzidi] Q-map: 45.6 MB, Sparse coords: 91.0 KB
[Bouzidi] Level 3: 5824 boundary cells
  Total: 1728 blocks, 0.88 M voxels
  Boundary: Bouzidi IBM (5824 cells, sparse)

[Verify] Checking parent coverage...
  Level 2: ✓ (missing parents: 0)
  Level 3: ✓ (missing parents: 0)
[Info] Re = 266667.0, τ_levels = 0.500034, 0.500017, 0.500008
[00:00:07.39] Transferring to GPU...
[00:00:08.15] Initializing equilibrium...
[Info] Total cells: 1.6 M

======================================================================
                    VRAM BREAKDOWN BY LEVEL
======================================================================

┌─ Level 1: 392 blocks, 0.20M cells ─────────────────────────
│  Distributions:         41.3 MB  (f + f_temp)
│  Macroscopic:            5.4 MB  (rho, u, u_temp)
│  Geometry:               1.7 MB  (obs, sponge, wall)
│  ────────────────────────────────────────────────────────
│  Level Total:           48.5 MB
└──────────────────────────────────────────────────────────────

┌─ Level 2: 1000 blocks, 0.51M cells ─────────────────────────
│  Distributions:        105.5 MB  (f + f_temp)
│  Macroscopic:           13.7 MB  (rho, u, u_temp)
│  Geometry:               4.4 MB  (obs, sponge, wall)
│  ────────────────────────────────────────────────────────
│  Level Total:          123.7 MB
└──────────────────────────────────────────────────────────────

┌─ Level 3: 1728 blocks, 0.88M cells ─────────────────────────
│  Distributions:        182.2 MB  (f + f_temp)
│  Macroscopic:           23.6 MB  (rho, u, u_temp)
│  Geometry:               7.6 MB  (obs, sponge, wall)
│  Bouzidi:               45.6 MB  (5824 boundary cells)
│  ────────────────────────────────────────────────────────
│  Level Total:          259.3 MB
└──────────────────────────────────────────────────────────────

======================================================================
                          MEMORY SUMMARY
======================================================================
  Distributions:        329.1 MB  ( 76.3%)
  Macroscopic:           42.7 MB  (  9.9%)
  Geometry:              13.7 MB  (  3.2%)
  Connectivity:           0.4 MB  (  0.1%)
  Bouzidi IBM:           45.6 MB  ( 10.6%)
----------------------------------------------------------------------
  TOTAL ALLOCATED:      431.4 MB
----------------------------------------------------------------------
  CUDA REPORTED:       2012.4 MB (Includes driver + overhead)
  Driver Overhead:     1580.9 MB
  Free VRAM:           8227.0 MB
======================================================================
[Forces] Initialized surface stress method for 20480 triangles
         Reference: ρ=1.225 kg/m³, U=4.0 m/s
         Reference: A=1.0 m², L=1.0 m
[00:00:17.79] LBM Analysis STARTED

    Step |     Walltime |    Time[s] |   U_lat |   ρ_min |  MLUPS |       Cd |       Cl
------------------------------------------------------------------------------------------
[Surface] Mapped 20480 triangles:
          Mesh offset: (4.25, 4.48, 4.48)
          Grid spacing dx = 0.04 m
          Pressure scale = 21777.78 Pa
          Coverage: pressure=20480/20480 (100.0%)
          Pressure range: [6.404e-02, 1.377e+00] Pa
     200 |  00:00:37.57 |     0.0600 | 0.0007 | 0.9996 |   18.2 |   0.0633 |  -0.0001
     400 |  00:00:41.36 |     0.1200 | 0.0029 | 0.9992 |   57.8 |   0.1450 |   0.0002
     600 |  00:00:44.66 |     0.1800 | 0.0062 | 0.9988 |   96.8 |   0.2152 |   0.0006
     800 |  00:00:47.93 |     0.2400 | 0.0104 | 0.9985 |   97.5 |   0.2725 |   0.0012
    1000 |  00:00:51.28 |     0.3000 | 0.0150 | 0.9984 |   95.5 |   0.3242 |   0.0018
[00:00:51.98] VTK Export START for step 1000
[00:01:03.43] VTK Export END (1.42M cells, 11.5s)
[VTK] Saved: C:\01_LBM\v90_2026_02_01_LUDWIG_STL_loads_claude_\CASES\ball1m\RESULTS/surface_001000.vtu (20480/20480 triangles mapped)
    1200 |  00:01:07.11 |     0.3600 | 0.0196 | 0.9985 |   20.2 |   0.3737 |   0.0029
    1400 |  00:01:10.37 |     0.4200 | 0.0238 | 0.9987 |   97.9 |   0.4154 |   0.0039
    1600 |  00:01:13.64 |     0.4800 | 0.0271 | 0.9988 |   97.8 |   0.4371 |   0.0051
    1800 |  00:01:16.95 |     0.5400 | 0.0293 | 0.9984 |   96.9 |   0.4246 |   0.0068
    2000 |  00:01:20.23 |     0.6000 | 0.0300 | 0.9981 |   96.9 |   0.3675 |   0.0103
[00:01:20.23] VTK Export START for step 2000
[00:01:30.92] VTK Export END (1.42M cells, 10.7s)
[VTK] Saved: C:\01_LBM\v90_2026_02_01_LUDWIG_STL_loads_claude_\CASES\ball1m\RESULTS/surface_002000.vtu (20480/20480 triangles mapped)
    2200 |  00:01:34.48 |     0.6600 | 0.0300 | 0.9981 |   22.4 |   0.3422 |   0.0169
    2400 |  00:01:37.79 |     0.7200 | 0.0300 | 0.9981 |   96.5 |   0.3294 |   0.0299
    2600 |  00:01:41.08 |     0.7800 | 0.0300 | 0.9982 |   97.4 |   0.3209 |   0.0510
    2800 |  00:01:44.37 |     0.8400 | 0.0300 | 0.9982 |   96.9 |   0.3179 |   0.0802
    3000 |  00:01:47.77 |     0.9000 | 0.0300 | 0.9982 |   94.1 |   0.3268 |   0.1201
[00:01:47.77] VTK Export START for step 3000
[00:01:58.69] VTK Export END (1.42M cells, 10.9s)
[VTK] Saved: C:\01_LBM\v90_2026_02_01_LUDWIG_STL_loads_claude_\CASES\ball1m\RESULTS/surface_003000.vtu (20480/20480 triangles mapped)
    3200 |  00:02:02.33 |     0.9600 | 0.0300 | 0.9983 |   21.9 |   0.3629 |   0.1735
    3400 |  00:02:05.81 |     1.0200 | 0.0300 | 0.9983 |   91.9 |   0.4259 |   0.2352
    3600 |  00:02:09.18 |     1.0800 | 0.0300 | 0.9983 |   94.8 |   0.4971 |   0.2649
    3800 |  00:02:12.50 |     1.1400 | 0.0300 | 0.9983 |   96.3 |   0.4968 |   0.1967
    4000 |  00:02:15.83 |     1.2000 | 0.0300 | 0.9983 |   96.0 |   0.4179 |   0.0622
[00:02:15.83] VTK Export START for step 4000
[00:02:26.71] VTK Export END (1.42M cells, 10.9s)
[VTK] Saved: C:\01_LBM\v90_2026_02_01_LUDWIG_STL_loads_claude_\CASES\ball1m\RESULTS/surface_004000.vtu (20480/20480 triangles mapped)
    4200 |  00:02:30.42 |     1.2600 | 0.0300 | 0.9983 |   21.9 |   0.3362 |  -0.1190
    4400 |  00:02:34.12 |     1.3200 | 0.0300 | 0.9983 |   86.3 |   0.3450 |  -0.1655
    4600 |  00:02:37.51 |     1.3800 | 0.0300 | 0.9983 |   94.2 |   0.3744 |  -0.1483
    4800 |  00:02:41.11 |     1.4400 | 0.0300 | 0.9983 |   88.9 |   0.3847 |  -0.1118
    5000 |  00:02:44.61 |     1.5000 | 0.0300 | 0.9983 |   91.1 |   0.3792 |  -0.0662
[00:02:44.61] VTK Export START for step 5000
[00:02:55.53] VTK Export END (1.42M cells, 10.9s)
[VTK] Saved: C:\01_LBM\v90_2026_02_01_LUDWIG_STL_loads_claude_\CASES\ball1m\RESULTS/surface_005000.vtu (20480/20480 triangles mapped)
    5200 |  00:02:59.08 |     1.5600 | 0.0300 | 0.9983 |   22.1 |   0.3500 |  -0.0084
    5400 |  00:03:02.37 |     1.6200 | 0.0300 | 0.9983 |   96.9 |   0.3588 |   0.0134
    5600 |  00:03:05.64 |     1.6800 | 0.0300 | 0.9983 |   97.9 |   0.4114 |  -0.0648
    5800 |  00:03:08.94 |     1.7400 | 0.0300 | 0.9983 |   96.9 |   0.4448 |  -0.1306
    6000 |  00:03:12.22 |     1.8000 | 0.0300 | 0.9983 |   97.4 |   0.4473 |  -0.1210
[00:03:12.22] VTK Export START for step 6000
[00:03:22.95] VTK Export END (1.42M cells, 10.7s)
[VTK] Saved: C:\01_LBM\v90_2026_02_01_LUDWIG_STL_loads_claude_\CASES\ball1m\RESULTS/surface_006000.vtu (20480/20480 triangles mapped)

======================================================================
    SIMULATION COMPLETE | Wall time: 184.8 s | Performance: 51.9 MLUPS
======================================================================

============================================================
         AERODYNAMIC FORCES SUMMARY
============================================================

Reference Values:
  ρ_ref  = 1.2250 kg/m³
  U_ref  = 4.0000 m/s
  A_ref  = 1.0000 m²
  L_ref  = 1.0000 m
  q_∞    = 9.8000 Pa

Forces [N]:
  Fx (drag)  = +4.3832e+00  (pressure: +4.3830e+00, viscous: +1.7666e-04)
  Fy (side)  = -5.5307e-01  (pressure: -5.5305e-01, viscous: -1.4236e-05)
  Fz (lift)  = -1.1855e+00  (pressure: -1.1855e+00, viscous: -1.9322e-05)

Moments [N·m]:
  Mx (roll)  = -1.3845e-06
  My (pitch) = +2.9638e-01
  Mz (yaw)   = -1.3827e-01

Coefficients:
  Cd = +0.447263
  Cl = -0.120969
  Cs = -0.056435
  Cmy = +0.030243

Drag breakdown: 100.0% pressure, 0.0% viscous
============================================================

[Memory] VRAM: 7.97 GB free / 10.00 GB total

======================================================================
      ALL CASES COMPLETED
======================================================================
