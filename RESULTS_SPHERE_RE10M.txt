$ julia -t auto main.jl
┌ Error: You are using CUDA 13.1.0, but CUDA.jl was precompiled for CUDA 13.0.0.
│ This is unexpected; please file an issue.
└ @ CUDA C:\Users\USUARIO\.julia\packages\CUDA\FJf6p\src\initialization.jl:148
[Init] Module loaded (ROBUST VERSION)
======================================================================
      MULTI-CASE EXECUTION: 1 cases
======================================================================

>>> CASE 1/1: ball1m
[Init] Loading: ball1m
[Init] ═══════════════════════════════════════════════════════
[Init] STABILITY SETTINGS:
[Init]    Background ν_sgs: 0.000500 → τ_eff_min ≈ 0.5015
[Init]    Sponge f-blending: true
[Init]    Temporal interpolation: true
[Init] ═══════════════════════════════════════════════════════

======================================================================
    LBM SOLVER | D3Q27 | WALE LES | SURFACE FORCE METHOD
    Case: ball1m | 2026-02-01T23:33:12.106
======================================================================

[Config] Stability Settings:
          Background ν_sgs: 0.000500 → τ_eff_min ≈ 0.5015
          Sponge f-blending: true
          Temporal interpolation: true
[Memory] VRAM: 8.85 GB free / 10.00 GB total
[Backend] CUDA: NVIDIA GeForce RTX 3080
[00:00:00.91] Building domain...
[Domain] Loading: C:\01_LBM\v91_2026_02_01_LUDWIG_STL_loads_claude_validation_runs\CASES\ball1m\ball1m.stl
[Geometry] Loading STL from: C:\01_LBM\v91_2026_02_01_LUDWIG_STL_loads_claude_validation_runs\CASES\ball1m\ball1m.stl
[Geometry] Format: Binary STL
[Geometry] Loaded 20480 triangles.
[Geometry] Bounds: [-0.5, 0.5] x [-0.5, 0.5] x [-0.5, 0.5]

[High-Re] ═══════════════════════════════════════════════════════
[High-Re] Re = 9.87e+06, L = 1.0000 m, N = 55 cells/L, U_lat = 0.030
[High-Re] Computed τ_fine = 0.500001
[High-Re] Effective τ_min (with ν_sgs_bg) = 0.501500
[High-Re] ⚠ τ ≈ 0.5 (stability limit) - background ν_sgs active
[High-Re] ═══════════════════════════════════════════════════════

╔══════════════════════════════════════════════════════════════════╗
║                 LBM DOMAIN CONFIGURATION SUMMARY                 ║
╠══════════════════════════════════════════════════════════════════╣
║  Case: ball1m                                        ║
║  Re = 9866667      | 4 levels | Est. 0.07 GB                    ║
╚══════════════════════════════════════════════════════════════════╝

======================================================================
[Setup] Multi-Level Domain Generation
        Strategy: Geometry-First (Direct Mesh Check)
        Boundary: Bouzidi IBM (finest 1 level(s))
        Temporal Interpolation: ENABLED
======================================================================

--- Level 1 ---
  Generating Full Wind Tunnel for Level 1...
  Full domain: 8×8×8 = 512 blocks
[Domain] SAT Surface Marking...
[Domain] Flood Fill...
[Domain] Filled 44 interior voxels.
[Domain] Applying Sponge Layers...
[Domain] Sponge: 32.0% cells affected, max strength = 0.993
[Domain] Computing wall distances...
[Domain] Found 447 near-wall cells
  Total: 512 blocks, 0.26 M voxels
  Boundary: Simple bounce-back

--- Level 2 ---
  Added 1664 halo blocks
[Domain] SAT Surface Marking...
[Domain] Flood Fill...
[Domain] Filled 778 interior voxels.
[Domain] Applying Sponge Layers...
[Domain] Sponge: 3.1% cells affected, max strength = 0.048
[Domain] Computing wall distances...
[Domain] Found 1364 near-wall cells
  Total: 1728 blocks, 0.88 M voxels
  Boundary: Simple bounce-back

--- Level 3 ---
  Added 1772 halo blocks
[Domain] SAT Surface Marking...
[Domain] Flood Fill...
[Domain] Filled 8342 interior voxels.
[Domain] Applying Sponge Layers...
[Domain] Sponge: 0.0% cells affected, max strength = 0.000
[Domain] Computing wall distances...
[Domain] Found 4300 near-wall cells
  Total: 1856 blocks, 0.95 M voxels
  Boundary: Simple bounce-back

--- Level 4 ---
  Added 3250 halo blocks
[Domain] SAT Surface Marking...
[Domain] Flood Fill...
[Domain] Filled 76288 interior voxels.
[Domain] Applying Sponge Layers...
[Domain] Sponge: 0.0% cells affected, max strength = 0.000
[Domain] Computing wall distances...
[Domain] Found 14281 near-wall cells
[Bouzidi] Computing Q-map and surface mapping for Level 4...
[Bouzidi] Computing Q-values and surface mapping for 3552 blocks...
[Bouzidi] Found 28400 boundary cells (1.56%)
[Bouzidi] Q-map: 93.7 MB, Sparse coords: 443.8 KB
[Bouzidi] Level 4: 28400 boundary cells
  Total: 3552 blocks, 1.82 M voxels
  Boundary: Bouzidi IBM (28400 cells, sparse)

[Verify] Checking parent coverage...
  Level 2: ✓ (missing parents: 0)
  Level 3: ✓ (missing parents: 0)
  Level 4: ✓ (missing parents: 0)
[Info] Re = 9.866667e6, τ_levels = 0.500008, 0.500004, 0.500002, 0.500001
[00:00:07.59] Transferring to GPU...
[00:00:08.51] Initializing equilibrium...
[Info] Total cells: 3.92 M

======================================================================
                    VRAM BREAKDOWN BY LEVEL
======================================================================

┌─ Level 1: 512 blocks, 0.26M cells ─────────────────────────
│  Distributions:         54.0 MB  (f + f_temp)
│  Macroscopic:            7.0 MB  (rho, u, u_temp)
│  Geometry:               2.2 MB  (obs, sponge, wall)
│  ────────────────────────────────────────────────────────
│  Level Total:           63.3 MB
└──────────────────────────────────────────────────────────────

┌─ Level 2: 1728 blocks, 0.88M cells ─────────────────────────
│  Distributions:        182.2 MB  (f + f_temp)
│  Macroscopic:           23.6 MB  (rho, u, u_temp)
│  Geometry:               7.6 MB  (obs, sponge, wall)
│  ────────────────────────────────────────────────────────
│  Level Total:          213.7 MB
└──────────────────────────────────────────────────────────────

┌─ Level 3: 1856 blocks, 0.95M cells ─────────────────────────
│  Distributions:        195.8 MB  (f + f_temp)
│  Macroscopic:           25.4 MB  (rho, u, u_temp)
│  Geometry:               8.2 MB  (obs, sponge, wall)
│  ────────────────────────────────────────────────────────
│  Level Total:          229.5 MB
└──────────────────────────────────────────────────────────────

┌─ Level 4: 3552 blocks, 1.82M cells ─────────────────────────
│  Distributions:        374.6 MB  (f + f_temp)
│  Macroscopic:           48.6 MB  (rho, u, u_temp)
│  Geometry:              15.6 MB  (obs, sponge, wall)
│  Bouzidi:               93.8 MB  (28400 boundary cells)
│  ────────────────────────────────────────────────────────
│  Level Total:          533.3 MB
└──────────────────────────────────────────────────────────────

======================================================================
                          MEMORY SUMMARY
======================================================================
  Distributions:        806.6 MB  ( 77.6%)
  Macroscopic:          104.6 MB  ( 10.1%)
  Geometry:              33.6 MB  (  3.2%)
  Connectivity:           1.2 MB  (  0.1%)
  Bouzidi IBM:           93.8 MB  (  9.0%)
----------------------------------------------------------------------
  TOTAL ALLOCATED:     1039.8 MB
----------------------------------------------------------------------
  CUDA REPORTED:       3068.4 MB (Includes driver + overhead)
  Driver Overhead:     2028.6 MB
  Free VRAM:           7171.0 MB
======================================================================
[Forces] Initialized surface stress method for 20480 triangles
         Reference: ρ=1.225 kg/m³, U=148.0 m/s
         Reference: A=1.0 m², L=1.0 m
[00:00:18.21] LBM Analysis STARTED

    Step |     Walltime |    Time[s] |   U_lat |   ρ_min |  MLUPS |       Cd |       Cl
------------------------------------------------------------------------------------------
[Surface] Mapped 20480 triangles:
          Mesh offset: (4.25, 4.655, 4.655)
          Grid spacing dx = 0.018182 m
          Pressure scale = 2.981378e7 Pa
          Coverage: pressure=20458/20480 (99.9%)
          Pressure range: [-3.151e+02, 1.488e+03] Pa
     200 |  00:00:46.82 |     0.0007 | 0.0007 | 0.9996 |   29.7 |   0.0744 |   0.0001
     400 |  00:01:00.17 |     0.0015 | 0.0029 | 0.9992 |   52.0 |   0.1660 |  -0.0001
     600 |  00:01:12.90 |     0.0022 | 0.0062 | 0.9988 |   61.5 |   0.2404 |  -0.0000
     800 |  00:01:25.88 |     0.0029 | 0.0104 | 0.9985 |   60.3 |   0.2930 |  -0.0001
    1000 |  00:01:39.10 |     0.0037 | 0.0150 | 0.9984 |   59.3 |   0.3254 |  -0.0004
    1200 |  00:01:52.55 |     0.0044 | 0.0196 | 0.9985 |   58.2 |   0.3462 |  -0.0008
    1400 |  00:02:05.31 |     0.0052 | 0.0238 | 0.9987 |   61.4 |   0.3648 |  -0.0012
    1600 |  00:02:19.35 |     0.0059 | 0.0271 | 0.9989 |   55.8 |   0.3759 |   0.0008
    1800 |  00:02:32.45 |     0.0066 | 0.0293 | 0.9985 |   59.8 |   0.3570 |   0.0086
    2000 |  00:02:45.68 |     0.0074 | 0.0300 | 0.9983 |   59.2 |   0.3005 |   0.0283
    2200 |  00:02:58.75 |     0.0081 | 0.0300 | 0.9983 |   59.9 |   0.2916 |   0.0677
    2400 |  00:03:12.01 |     0.0088 | 0.0300 | 0.9984 |   59.1 |   0.2978 |   0.1313
    2600 |  00:03:25.22 |     0.0096 | 0.0300 | 0.9984 |   59.3 |   0.3343 |   0.2257
    2800 |  00:03:38.37 |     0.0103 | 0.0300 | 0.9984 |   59.5 |   0.4435 |   0.3352
    3000 |  00:03:51.37 |     0.0111 | 0.0300 | 0.9985 |   60.2 |   0.5930 |   0.3371
[00:03:52.04] VTK Export START for step 3000
[00:04:20.25] VTK Export END (3.46M cells, 28.2s)
[VTK] Saved: C:\01_LBM\v91_2026_02_01_LUDWIG_STL_loads_claude_validation_runs\CASES\ball1m\RESULTS/surface_003000.vtu (20480/20480 triangles mapped)
    3200 |  00:04:33.84 |     0.0118 | 0.0300 | 0.9985 |   18.4 |   0.5356 |   0.2743
    3400 |  00:04:47.04 |     0.0125 | 0.0300 | 0.9985 |   59.3 |   0.3034 |   0.0442
    3600 |  00:04:59.68 |     0.0133 | 0.0300 | 0.9985 |   61.9 |   0.3016 |  -0.0884
    3800 |  00:05:12.42 |     0.0140 | 0.0300 | 0.9985 |   61.5 |   0.4091 |  -0.1783
    4000 |  00:05:25.14 |     0.0147 | 0.0300 | 0.9985 |   61.6 |   0.4252 |  -0.2291
    4200 |  00:05:37.90 |     0.0155 | 0.0300 | 0.9985 |   61.4 |   0.4376 |  -0.1880
    4400 |  00:05:50.61 |     0.0162 | 0.0300 | 0.9985 |   61.6 |   0.3915 |  -0.1169
    4600 |  00:06:03.35 |     0.0170 | 0.0300 | 0.9985 |   61.5 |   0.3407 |  -0.0518
    4800 |  00:06:16.06 |     0.0177 | 0.0300 | 0.9985 |   61.6 |   0.3258 |   0.0063
    5000 |  00:06:29.11 |     0.0184 | 0.0300 | 0.9985 |   60.0 |   0.2966 |  -0.0050
    5200 |  00:06:42.08 |     0.0192 | 0.0300 | 0.9985 |   60.4 |   0.3320 |  -0.0364
    5400 |  00:06:55.43 |     0.0199 | 0.0300 | 0.9985 |   58.7 |   0.3064 |  -0.0390
    5600 |  00:07:09.02 |     0.0206 | 0.0300 | 0.9985 |   57.6 |   0.3131 |   0.0805
    5800 |  00:07:21.79 |     0.0214 | 0.0300 | 0.9985 |   61.3 |   0.3439 |   0.1912
    6000 |  00:07:34.59 |     0.0221 | 0.0300 | 0.9985 |   61.2 |   0.3491 |   0.1754
[00:07:34.61] VTK Export START for step 6000
[00:08:01.98] VTK Export END (3.46M cells, 27.4s)
[VTK] Saved: C:\01_LBM\v91_2026_02_01_LUDWIG_STL_loads_claude_validation_runs\CASES\ball1m\RESULTS/surface_006000.vtu (20480/20480 triangles mapped)
    6200 |  00:08:15.54 |     0.0229 | 0.0300 | 0.9985 |   19.1 |   0.3609 |   0.0822
    6400 |  00:08:28.31 |     0.0236 | 0.0300 | 0.9985 |   61.4 |   0.3158 |  -0.0434
    6600 |  00:08:41.15 |     0.0243 | 0.0300 | 0.9985 |   61.0 |   0.3346 |  -0.0134
    6800 |  00:08:54.12 |     0.0251 | 0.0300 | 0.9985 |   60.4 |   0.3307 |   0.0314
    7000 |  00:09:07.20 |     0.0258 | 0.0300 | 0.9985 |   59.9 |   0.3088 |   0.0738
    7200 |  00:09:19.82 |     0.0265 | 0.0300 | 0.9985 |   62.1 |   0.2984 |   0.0616
    7400 |  00:09:32.51 |     0.0273 | 0.0300 | 0.9985 |   61.7 |   0.3087 |   0.0065
    7600 |  00:09:45.34 |     0.0280 | 0.0300 | 0.9985 |   61.1 |   0.3271 |   0.0137
    7800 |  00:09:58.42 |     0.0287 | 0.0300 | 0.9985 |   59.9 |   0.3504 |   0.0199
    8000 |  00:10:11.21 |     0.0295 | 0.0300 | 0.9985 |   61.2 |   0.3415 |   0.0129
    8200 |  00:10:24.12 |     0.0302 | 0.0300 | 0.9985 |   60.6 |   0.3431 |   0.0147
    8400 |  00:10:37.12 |     0.0310 | 0.0300 | 0.9985 |   60.3 |   0.3423 |  -0.0225
    8600 |  00:10:49.93 |     0.0317 | 0.0300 | 0.9985 |   61.1 |   0.3129 |  -0.0229
    8800 |  00:11:02.67 |     0.0324 | 0.0300 | 0.9985 |   61.5 |   0.2965 |  -0.0019
    9000 |  00:11:15.57 |     0.0332 | 0.0300 | 0.9985 |   60.7 |   0.3167 |  -0.0018
[00:11:15.57] VTK Export START for step 9000
[00:11:43.05] VTK Export END (3.46M cells, 27.5s)
[VTK] Saved: C:\01_LBM\v91_2026_02_01_LUDWIG_STL_loads_claude_validation_runs\CASES\ball1m\RESULTS/surface_009000.vtu (20480/20480 triangles mapped)
    9200 |  00:11:56.95 |     0.0339 | 0.0300 | 0.9985 |   18.9 |   0.3077 |   0.0212
    9400 |  00:12:09.78 |     0.0346 | 0.0300 | 0.9985 |   61.0 |   0.2990 |   0.0436
    9600 |  00:12:22.55 |     0.0354 | 0.0300 | 0.9985 |   61.4 |   0.2835 |   0.0380
    9800 |  00:12:35.24 |     0.0361 | 0.0300 | 0.9985 |   61.7 |   0.2982 |   0.0198
   10000 |  00:12:47.91 |     0.0369 | 0.0300 | 0.9985 |   61.8 |   0.3149 |   0.0171
   10200 |  00:13:00.58 |     0.0376 | 0.0300 | 0.9985 |   61.8 |   0.2976 |   0.0315
   10400 |  00:13:13.61 |     0.0383 | 0.0300 | 0.9985 |   60.1 |   0.2953 |   0.0688
   10600 |  00:13:26.49 |     0.0391 | 0.0300 | 0.9985 |   60.8 |   0.3139 |   0.1160
   10800 |  00:13:39.31 |     0.0398 | 0.0300 | 0.9985 |   61.1 |   0.3270 |   0.1665
   11000 |  00:13:52.16 |     0.0405 | 0.0300 | 0.9985 |   61.0 |   0.3429 |   0.1755
   11200 |  00:14:05.11 |     0.0413 | 0.0300 | 0.9985 |   60.5 |   0.3362 |   0.1731
   11400 |  00:14:17.94 |     0.0420 | 0.0300 | 0.9985 |   61.0 |   0.3483 |   0.1834
   11600 |  00:14:30.80 |     0.0428 | 0.0300 | 0.9985 |   60.9 |   0.3461 |   0.1556
   11800 |  00:14:43.64 |     0.0435 | 0.0300 | 0.9985 |   61.0 |   0.3552 |   0.1632
   12000 |  00:14:56.36 |     0.0442 | 0.0300 | 0.9985 |   61.6 |   0.3573 |   0.1609
[00:14:56.36] VTK Export START for step 12000
[00:15:23.79] VTK Export END (3.46M cells, 27.4s)
[VTK] Saved: C:\01_LBM\v91_2026_02_01_LUDWIG_STL_loads_claude_validation_runs\CASES\ball1m\RESULTS/surface_012000.vtu (20480/20480 triangles mapped)

======================================================================
    SIMULATION COMPLETE | Wall time: 905.1 s | Performance: 51.9 MLUPS
======================================================================

============================================================
         AERODYNAMIC FORCES SUMMARY
============================================================

Reference Values:
  ρ_ref  = 1.2250 kg/m³
  U_ref  = 148.0000 m/s
  A_ref  = 1.0000 m²
  L_ref  = 1.0000 m
  q_∞    = 13416.2000 Pa

Forces [N]:
  Fx (drag)  = +4.7935e+03  (pressure: +4.7935e+03, viscous: +1.1143e-02)
  Fy (side)  = +4.5618e+02  (pressure: +4.5618e+02, viscous: +9.0668e-04)
  Fz (lift)  = +2.1588e+03  (pressure: +2.1588e+03, viscous: +3.5013e-03)

Moments [N·m]:
  Mx (roll)  = +1.4290e-03
  My (pitch) = -5.3969e+02
  Mz (yaw)   = +1.1404e+02

Coefficients:
  Cd = +0.357291
  Cl = +0.160909
  Cs = +0.034002
  Cmy = -0.040227

Drag breakdown: 100.0% pressure, 0.0% viscous
============================================================

[Memory] VRAM: 6.94 GB free / 10.00 GB total

======================================================================
      ALL CASES COMPLETED
======================================================================
